<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SansiAsaf Proje</title>

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
}

body{
    overflow:hidden;
    font-family:Arial, sans-serif;
    background:black;
}

/* üé• BACKGROUND VIDEO */
#bgVideo{
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    object-fit:cover;
    z-index:-3;
}

/* üåà SHADER OVERLAY */
#shader{
    position:fixed;
    inset:0;
    z-index:-2;
    pointer-events:none;
    background:
        radial-gradient(circle at 50% 50%, rgba(255,255,255,0.05), transparent 70%),
        linear-gradient(to top, rgba(0,0,0,0.6), transparent 60%);
    animation: glowMove 6s infinite alternate ease-in-out;
}

@keyframes glowMove{
    from { transform:scale(1); opacity:0.8; }
    to { transform:scale(1.05); opacity:1; }
}

canvas{
    display:block;
}

/* üé¨ INTRO */
#intro{
    position:fixed;
    inset:0;
    display:flex;
    justify-content:center;
    align-items:center;
    font-size:40px;
    font-weight:bold;
    color:white;
    text-shadow:0 0 25px cyan;
    background:black;
    z-index:10;
}

/* üìù SORU PANEL */
#questionBox{
    position:fixed;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    background:rgba(0,0,0,0.85);
    padding:25px;
    border-radius:20px;
    text-align:center;
    display:none;
    color:white;
    width:400px;
}

.option{
    margin:8px;
    padding:8px;
    background:#333;
    border-radius:10px;
    cursor:pointer;
}

.option:hover{
    background:#555;
}

#nextBtn{
    margin-top:15px;
    padding:10px;
    background:gold;
    border:none;
    border-radius:10px;
    font-weight:bold;
    display:none;
    cursor:pointer;
}
</style>
</head>
<body>

<!-- üé• VIDEO -->
<video id="bgVideo" autoplay muted loop playsinline>
    <source src="background.mp4" type="video/mp4">
</video>

<!-- üåà SHADER -->
<div id="shader"></div>

<!-- üé¨ INTRO -->
<div id="intro">Tarafƒ±ndan Gelistirildi</div>

<canvas id="game"></canvas>

<div id="questionBox">
    <h3 id="questionText"></h3>
    <div id="options"></div>
    <button id="nextBtn">Ba≈üka soruya ge√ß</button>
</div>

<script src="questions.json"></script>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let gameStarted = false;
let gameOver = false;

let bird = {
    x: 200,
    y: canvas.height/2,
    width: 40,
    height: 40,
    gravity:0.6,
    lift:-10,
    velocity:0
};

let pipes = [];
let pipeWidth = 80;
let pipeGap = 200;
let score = 0;

/* üî• OPTIMIZED LOOP */
function gameLoop(){
    if(!gameStarted){
        requestAnimationFrame(gameLoop);
        return;
    }

    ctx.clearRect(0,0,canvas.width,canvas.height);

    updateBird();
    updatePipes();
    drawBird();

    if(!gameOver){
        requestAnimationFrame(gameLoop);
    }
}

function updateBird(){
    bird.velocity += bird.gravity;
    bird.y += bird.velocity;

    if(bird.y <= 0 || bird.y + bird.height >= canvas.height){
        triggerQuestion();
    }
}

function drawBird(){
    ctx.fillStyle="yellow";
    ctx.fillRect(bird.x,bird.y,bird.width,bird.height);
}

function updatePipes(){
    if(frameCount % 120 === 0){
        let topHeight = Math.random()*300 + 100;
        pipes.push({
            x: canvas.width,
            top: topHeight,
            bottom: canvas.height - topHeight - pipeGap
        });
    }

    for(let i=0;i<pipes.length;i++){
        let p = pipes[i];
        p.x -= 3;

        ctx.fillStyle="green";
        ctx.fillRect(p.x,0,pipeWidth,p.top);
        ctx.fillRect(p.x,canvas.height-p.bottom,pipeWidth,p.bottom);

        if(
            bird.x < p.x + pipeWidth &&
            bird.x + bird.width > p.x &&
            (bird.y < p.top ||
             bird.y + bird.height > canvas.height-p.bottom)
        ){
            triggerQuestion();
        }

        if(p.x + pipeWidth < 0){
            pipes.splice(i,1);
            i--;
        }
    }
}

let frameCount = 0;
setInterval(()=>{ frameCount++; },16);

document.addEventListener("keydown",()=>{
    if(!gameStarted) return;
    bird.velocity = bird.lift;
});

function triggerQuestion(){
    if(gameOver) return;
    gameOver = true;
    document.getElementById("questionBox").style.display="block";
    loadQuestion();
}

function loadQuestion(){
    let q = questions[Math.floor(Math.random()*questions.length)];
    document.getElementById("questionText").innerText=q.q;

    let optionsDiv = document.getElementById("options");
    optionsDiv.innerHTML="";

    q.options.forEach((opt,index)=>{
        let div = document.createElement("div");
        div.className="option";
        div.innerText=String.fromCharCode(65+index)+") "+opt;
        div.onclick=()=>{
            if(opt===q.answer){
                resetGame();
            }else{
                document.getElementById("nextBtn").style.display="block";
            }
        }
        optionsDiv.appendChild(div);
    });
}

document.getElementById("nextBtn").onclick=function(){
    this.style.display="none";
    loadQuestion();
}

function resetGame(){
    pipes=[];
    bird.y=canvas.height/2;
    bird.velocity=0;
    document.getElementById("questionBox").style.display="none";
    gameOver=false;
}

/* üé¨ 6 SANƒ∞YE INTRO */
setTimeout(()=>{
    document.getElementById("intro").style.display="none";
    gameStarted=true;
},6000);

gameLoop();
</script>

</body>
</html>
